define(["require"],(function(e){"use strict";const t=document.createElement("a"),r=()=>(e=>{const t=URL.createObjectURL(new Blob(["(",e.toString(),")()"],{type:"application/javascript"})),r=new Worker(t);return URL.revokeObjectURL(t),r})(()=>onmessage=async e=>{try{const t=await fetch(e.data.href,e.data.options),r=await t.blob();e.data.status=t.status,e.data.statusText=t.statusText,e.data.blob=r}catch(t){e.data.statusText=t}postMessage(e.data)});var s=new class{constructor(){this._worker=null,this._requests=0}terminate(){return this._requests>0&&this._requests--,0===this._requests&&(this._worker.terminate(),this._worker=null),this._worker}worker(){return this._requests++,this._worker||(this._worker=r()),this._worker}},a=new class{constructor(){this.cache={}}async fetch(e,t){return!0===(t={cache:!0,fetch:{},...t}).cache&&e in this.cache?await this.cache[e]:this.cache[e]=new Promise((r,a)=>{const n=s.worker();n.postMessage({href:e,options:t.fetch}),n.addEventListener("message",t=>{const n=t.data;n.href===e&&(s.terminate(),200!==n.status?a(new Error(`${n.statusText} for ${n.href} resource.`)):r(n.blob))})})}},n=async(e,t)=>{t={element:document,options:t};const r=URL.createObjectURL(e),s=new CSSStyleSheet;return await s.replace(`@import url("${r}")`),URL.revokeObjectURL(r),"object"==typeof t.element&&"adoptedStyleSheets"in t.element&&(t.element.adoptedStyleSheets=[...t.element.adoptedStyleSheets,s]),s},o=async(e,t)=>{const r=new FileReader,s=new Promise(e=>r.addEventListener("loadend",t=>e(t.srcElement.result)));r.readAsText(e);let a=await s;return t&&"string"==typeof t.filter&&t.filter.length&&(a=(new DOMParser).parseFromString(a,"text/html").body,a=[...a.querySelectorAll(t.filter)],a=a.length?a.map(e=>e.outerHTML).reduce((e,t)=>e+t):a),t&&t.element&&t.element instanceof HTMLElement&&a&&"string"==typeof a&&a.length&&(t.element.innerHTML=a),s},c=async(e,t)=>{const r=t&&t.element instanceof HTMLImageElement?t.element:new Image,s=URL.createObjectURL(e),a=new Promise((t,s)=>{r.onload=t,r.onerror=()=>s(new Error("Error loading image "+e.type))});r.src=s;const n=await a;return URL.revokeObjectURL(s),n},i=async t=>{const r=URL.createObjectURL(t),s=await new Promise((function(t,s){e([r],(function(e){t(function(e){if(e&&e.__esModule)return e;var t={};return e&&Object.keys(e).forEach((function(r){var s=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return e[r]}})})),t.default=e,t}(e))}),s)}));return URL.revokeObjectURL(r),s},l=new class{constructor(){this.loaders={image:c,html:o,css:n,javascript:i}}register(e,t){this.loaders[e]=t}async load(e,t){const r=e.type,s=r.split("/").reduce((e,t)=>[r,e,t]);for(const r in s){const a=s[r];if(a in this.loaders)return await this.loaders[a](e,t)}throw new TypeError(`Invalid ${e.type} media type passed to Loader class "load" method.`)}};return class{constructor(){}async fetch(e,r){if(Array.isArray(e))return await e.map(e=>this.fetch(e,r));if("string"==typeof e)return await this.fetch((s=e,t.href=s,new URL(t.href)),r);var s;if(e instanceof URL)return await a.fetch(e.href,r);throw new TypeError(`Invalid argment of type ${typeof e} passed to Loader class "fetch" method.`)}async load(e,t){if(Array.isArray(e)){const r=Array.isArray(t);return await e.map((e,s)=>this.load(e,r?t[s]:t))}const r=e instanceof Blob?e:await this.fetch(e,t);return await l.load(r,t)}register(e,t){return l.register(e,t)}}}));
//# sourceMappingURL=loader.amd.min.js.map
