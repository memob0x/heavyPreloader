!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define("Loader",["exports"],t):t((e=e||self).Loader={})}(this,function(e){"use strict";const t=e=>{const t=document.createElement("a");return t.href=e,t},r=e=>e.blob.type?URL.createObjectURL(e.blob):e.response.url,o=e=>"image",s=e=>e.host!==window.location.host,n=(e,t="src",r=new Image)=>new Promise((o,s)=>{r.onload=o,r.onerror=s,r.setAttribute(t,e)}),c=(e,t=document.createElement("div"))=>{const r=new CSSStyleSheet,o=r.replace(`@import url("${e}")`);return"adoptedStyleSheets"in t&&(t.adoptedStyleSheets=[...t.adoptedStyleSheets,r]),o},a=(e,t=document.createElement("object"))=>"OBJECT"===t.tagName?((e,t)=>new Promise((e,r)=>{t.onload=e,t.onerror=r,t.data=preload[i],t.width=0,t.height=0,document.body.append(t)}))(0,t):new Promise((r,o)=>{t.onload=r,t.onerror=o,t.src=e,t.async=!0,document.head.append(t)});var l=Object.freeze({__proto__:null,image:n,style:c,script:a}),d=()=>{onmessage=(async e=>{let t=e.data;try{const e=await fetch(t.url),r=await e.blob();t.response={url:e.url,status:e.status,statusText:e.statusText},t.blob=r}catch(e){t.response={url:t.url,status:200},t.blob={type:null}}postMessage(t)})};class u{constructor(e={}){this.worker=new Worker(URL.createObjectURL(new Blob(["(",d.toString(),")()"],{type:"application/javascript"}))),this._options={...e}}fetch(e){const r=t(e);return e=r.href,new Promise((t,n)=>{try{if(s(r)){const r=o(e),s={response:{url:e,status:200},blob:{type:null}};return r in l?l[r](e).then(()=>t(s)).catch(n):void t(s)}this.worker.postMessage({url:e}),this.worker.addEventListener("message",r=>{const o=r.data;o.url===e&&(200===o.response.status?t(o):n(new Error(`${o.response.statusText} ${o.response.url}`)))})}catch(e){n(e)}})}static adoptStyleSheet(e){const t=r(e);return c(t,document).finally(()=>URL.revokeObjectURL(t))}static insertScript(e){const t=r(e);return a(t,document.createElement("script")).finally(()=>URL.revokeObjectURL(t))}static setImageAttribute(e,t,o="src"){const s=r(e);return n(s,o,t).finally(()=>URL.revokeObjectURL(s))}}const p=new u;[...document.querySelectorAll("img[data-src]")].forEach(e=>p.fetch(e.dataset.src).then(t=>u.setImageAttribute(t,e)).catch(e=>console.error(e))),p.fetch("dist/styles.css").then(e=>u.adoptStyleSheet(e)).catch(e=>console.error(e)),p.fetch("dist/extra.css").then(e=>u.adoptStyleSheet(e)).catch(e=>console.error(e)),p.fetch("dist/scripts.js").then(e=>u.insertScript(e)).catch(e=>console.error(e)),p.fetch("dist/not-existent.js").then(e=>u.insertScript(e)).catch(e=>console.error(e)),e.Loader=u,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=loader.min.js.map
