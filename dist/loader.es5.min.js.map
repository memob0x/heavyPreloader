{"version":3,"sources":["loader.mjs"],"names":["_getRequireWildcardCache","WeakMap","cache","_interopRequireWildcard","obj","__esModule","_typeof","default","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","o","minLen","_arrayLikeToArray","n","toString","slice","constructor","name","Array","from","test","iter","Symbol","iterator","isArray","len","length","i","arr2","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","enumerable","push","apply","_objectSpread","target","arguments","source","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","value","configurable","writable","_classCallCheck","instance","Constructor","_defineProperties","props","descriptor","_createClass","protoProps","staticProps","asyncGeneratorStep","gen","resolve","reject","_next","_throw","arg","info","error","done","Promise","then","_asyncToGenerator","fn","self","this","args","err","undefined","global","factory","exports","module","define","amd","Loader","_ref2","_ref3","_ref4","_ref5","a","document","createElement","createFetchWorker","body","onmessage","_ref","regeneratorRuntime","mark","_callee","event","response","blob","wrap","_context","prev","next","fetch","data","href","options","sent","status","statusText","t0","postMessage","stop","_x","url","URL","createObjectURL","Blob","type","worker","Worker","revokeObjectURL","lworker","LoaderWorker","_worker","_requests","terminate","lfetch","LoaderFetch","_fetch","_callee2","_context2","abrupt","addEventListener","Error","concat","_x2","_x3","css","_callee3","sheet","_context3","element","CSSStyleSheet","replace","adoptedStyleSheets","_x4","_x5","html","_callee4","reader","promise","result","_context4","FileReader","buffer","srcElement","readAsText","DOMParser","parseFromString","querySelectorAll","map","x","outerHTML","reduce","y","HTMLElement","innerHTML","_x6","_x7","image","_callee5","_context5","HTMLImageElement","Image","onload","onerror","src","_x8","_x9","javascript","_callee6","_context6","require","_x10","lload","LoaderLoad","loaders","loader","_load","_callee7","_context7","split","t1","_x11","_x12","_fetch2","_callee8","resource","_this","_context8","path","_x13","_x14","_load2","_callee9","isArrayOpts","_this2","_context9","load","_x15","_x16","register"],"mappings":"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","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define('Loader', factory) :\n    (global = global || self, global.Loader = factory());\n}(this, (function () { 'use strict';\n\n    const a = document.createElement(\"a\");\n\n    /**\n     *\n     * @param {String} path\n     * @returns {URL}\n     */\n    const getURL = (path) => {\n        a.href = path;\n\n        return new URL(a.href);\n    };\n\n    /**\n     *\n     * @private\n     * @static\n     * TODO: provide unit test\n     */\n    const createDynamicWorker = (body) => {\n        // ...\n        const url = URL.createObjectURL(\n            new Blob([\"(\", body.toString(), \")()\"], {\n                type: \"application/javascript\",\n            })\n        );\n\n        // ...\n        const worker = new Worker(url);\n\n        // ...\n        URL.revokeObjectURL(url);\n\n        // ...\n        return worker;\n    };\n\n    /**\n     *\n     * @private\n     * @static\n     * TODO: provide unit test\n     */\n    const createFetchWorker = () =>\n        createDynamicWorker(\n            () =>\n                (onmessage = async (event) => {\n                    //\n                    try {\n                        const response = await fetch(\n                            event.data.href,\n                            event.data.options\n                        );\n                        const blob = await response.blob();\n\n                        event.data.status = response.status;\n                        event.data.statusText = response.statusText;\n                        event.data.blob = blob;\n                    } catch (e) {\n                        event.data.statusText = e;\n                    }\n\n                    // ...\n                    postMessage(event.data);\n                })\n        );\n\n    /**\n     *\n     */\n    var lworker = new (class LoaderWorker {\n        constructor() {\n            this._worker = null;\n\n            this._requests = 0;\n        }\n\n        terminate() {\n            //\n            //\n            if (this._requests > 0) {\n                this._requests--;\n            }\n\n            //\n            if (this._requests === 0) {\n                this._worker.terminate();\n\n                this._worker = null;\n            }\n\n            //\n            return this._worker;\n        }\n\n        worker() {\n            // ...\n            this._requests++;\n\n            // ...\n            if (this._worker) {\n                return this._worker;\n            }\n\n            // ...\n            this._worker = createFetchWorker();\n\n            //\n            return this._worker;\n        }\n    })();\n\n    /**\n     *\n     */\n    var lfetch = new (class LoaderFetch {\n        constructor() {\n            // ...\n            this.cache = {};\n        }\n\n        /**\n         * Fetches a resource url in the secondary thread and retrieves it as a blob\n         * @private\n         * @param {String} href The resource url to be fetched\n         * @param {Object} options The fetch options object\n         * @returns {Promise} The fetch promise\n         */\n        async fetch(href, options) {\n            // ...\n            options = {\n                ...{\n                    cache: true,\n                    fetch: {},\n                },\n                ...options,\n            };\n\n            // ...\n            if (options.cache === true && href in this.cache) {\n                return await this.cache[href];\n            }\n\n            // ...\n            return (this.cache[href] = new Promise((resolve, reject) => {\n                //\n                const worker = lworker.worker();\n\n                // ...\n                worker.postMessage({\n                    href: href,\n                    options: options.fetch,\n                });\n\n                // ...\n                // TODO: possibly use messageerror for reject?\n                worker.addEventListener(\"message\", (event) => {\n                    const data = event.data;\n\n                    // ...\n                    if (data.href !== href) {\n                        return;\n                    }\n\n                    //\n                    lworker.terminate();\n\n                    // ...\n                    if (data.status === 200) {\n                        resolve(data.blob);\n\n                        return;\n                    }\n\n                    // ...\n                    reject(\n                        new Error(`${data.statusText} for ${data.href} resource.`)\n                    );\n                });\n            }));\n        }\n    })();\n\n    var css = async (blob, options) => {\n        //\n        options = { ...{ element: document }, options };\n\n        //\n        const url = URL.createObjectURL(blob);\n\n        //\n        const sheet = new CSSStyleSheet();\n\n        //\n        await sheet.replace(`@import url(\"${url}\")`);\n\n        //\n        URL.revokeObjectURL(url);\n\n        //\n        if (\n            typeof options.element === \"object\" &&\n            \"adoptedStyleSheets\" in options.element\n        ) {\n            options.element.adoptedStyleSheets = [\n                ...options.element.adoptedStyleSheets,\n                sheet,\n            ];\n        }\n\n        //\n        return sheet;\n    };\n\n    var html = async (blob, options) => {\n        //\n        const reader = new FileReader();\n\n        //\n        const promise = new Promise((resolve) =>\n            reader.addEventListener(\"loadend\", (buffer) =>\n                resolve(buffer.srcElement.result)\n            )\n        );\n\n        //\n        reader.readAsText(blob);\n\n        //\n        let result = await promise;\n\n        //\n        if (\n            options &&\n            typeof options.filter === \"string\" &&\n            options.filter.length\n        ) {\n            //\n            result = new DOMParser().parseFromString(result, \"text/html\").body;\n            //\n            result = [...result.querySelectorAll(options.filter)];\n            //\n            result = result.length\n                ? result.map((x) => x.outerHTML).reduce((x, y) => x + y)\n                : result;\n        }\n\n        //\n        if (\n            options &&\n            options.element &&\n            options.element instanceof HTMLElement &&\n            result &&\n            typeof result === \"string\" &&\n            result.length\n        ) {\n            options.element.innerHTML = result;\n        }\n\n        //\n        return promise;\n    };\n\n    var image = async (blob, options) => {\n        //\n        const image =\n            options && options.element instanceof HTMLImageElement\n                ? options.element\n                : new Image();\n\n        //\n        const url = URL.createObjectURL(blob);\n\n        //\n        const promise = new Promise((resolve, reject) => {\n            image.onload = resolve;\n            image.onerror = () =>\n                reject(new Error(`Error loading image ${blob.type}`));\n        });\n\n        //\n        image.src = url;\n\n        //\n        const result = await promise;\n\n        //\n        URL.revokeObjectURL(url);\n\n        //\n        return result;\n    };\n\n    var javascript = async (blob) => {\n        //\n        const url = URL.createObjectURL(blob);\n\n        //\n        const result = await import(url);\n\n        //\n        URL.revokeObjectURL(url);\n\n        //\n        return result;\n    };\n\n    /**\n     *\n     */\n    var lload = new (class LoaderLoad {\n        constructor() {\n            // loaders closure, filled with default loaders\n            // https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types\n            this.loaders = {\n                image: image,\n                html: html,\n                css: css,\n                javascript: javascript,\n            };\n        }\n\n        /**\n         *\n         * @param {String} type\n         * @param {Function} loader\n         * @returns {void}\n         */\n        register(type, loader) {\n            this.loaders[type] = loader;\n        }\n\n        /**\n         * Loads a resource, which usually consists in attaching it to an existent DOM element\n         * @private\n         * @param {Blob} blob The resource to be loaded in Blob form\n         * @param {Object} options The resource load options\n         * @returns {Promise} The resource load in promise form\n         */\n        async load(blob, options) {\n            const type = blob.type;\n\n            //...\n            const keys = type.split(\"/\").reduce((x, y) => [type, x, y]);\n\n            // ...\n            for (const key in keys) {\n                const loader = keys[key];\n\n                if (loader in this.loaders) {\n                    return await this.loaders[loader](blob, options);\n                }\n            }\n\n            // ...\n            throw new TypeError(\n                `Invalid ${blob.type} media type passed to Loader class \"load\" method.`\n            );\n        }\n    })();\n\n    class Loader {\n        constructor() {}\n\n        /**\n         * Fetches one or more resources url\n         * @param {Array.<String>|Array.<URL>|String|URL} resource The resource(s) url to be fetched in a separate thread\n         * @param {Object} options The fetch options object\n         * @returns {Array.<Promise>|Promise} The fetch promise(s)\n         */\n        async fetch(resource, options) {\n            // ...\n            if (Array.isArray(resource)) {\n                return await resource.map((a) => this.fetch(a, options));\n            }\n\n            // ...\n            if (typeof resource === \"string\") {\n                return await this.fetch(getURL(resource), options);\n            }\n\n            // ...\n            if (resource instanceof URL) {\n                return await lfetch.fetch(resource.href, options);\n            }\n\n            // ...\n            throw new TypeError(\n                `Invalid argment of type ${typeof resource} passed to Loader class \"fetch\" method.`\n            );\n        }\n\n        /**\n         * Loads one or more resources url considering the passed options object and the resource mime type to be loaded\n         * @param {Array.<String>|Array.<URL>|Array.<Blob>|String|URL|Blob} resource The resource(s) to be loaded\n         * @param {Object} options The loader type options\n         * @returns {Array.<Promise>|Promise} The load promise(s)\n         */\n        async load(resource, options) {\n            // ...\n            if (Array.isArray(resource)) {\n                const isArrayOpts = Array.isArray(options);\n\n                return await resource.map((a, i) =>\n                    this.load(a, isArrayOpts ? options[i] : options)\n                );\n            }\n\n            // ...\n            const blob =\n                resource instanceof Blob\n                    ? resource\n                    : await this.fetch(resource, options);\n\n            // ...\n            return await lload.load(blob, options);\n        }\n\n        /**\n         *\n         * @param {String} type\n         * @param {Function} loader\n         * @returns {void}\n         */\n        register(type, loader) {\n            return lload.register(type, loader);\n        }\n    }\n\n    return Loader;\n\n})));\n"],"file":"loader.es5.min.js"}