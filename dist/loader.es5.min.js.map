{"version":3,"sources":["loader.mjs"],"names":["_getRequireWildcardCache","WeakMap","cache","_interopRequireWildcard","obj","__esModule","_typeof","default","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","o","minLen","_arrayLikeToArray","n","toString","slice","constructor","name","Array","from","test","iter","Symbol","iterator","isArray","len","length","i","arr2","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","enumerable","push","apply","_objectSpread","target","arguments","source","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","value","configurable","writable","_classCallCheck","instance","Constructor","_defineProperties","props","descriptor","_createClass","protoProps","staticProps","asyncGeneratorStep","gen","resolve","reject","_next","_throw","arg","info","error","done","Promise","then","_asyncToGenerator","fn","self","this","args","err","undefined","global","factory","exports","module","define","amd","Loader","_ref2","_ref3","_ref4","_ref5","_ref6","_ref7","a","document","createElement","createFetchWorker","body","onmessage","_ref","regeneratorRuntime","mark","_callee","event","response","blob","wrap","_context","prev","next","fetch","data","href","options","sent","status","statusText","t0","postMessage","stop","_x","url","URL","createObjectURL","Blob","type","worker","Worker","revokeObjectURL","lworker","LoaderWorker","_worker","_requests","terminate","lfetch","_callee2","_context2","abrupt","addEventListener","Error","concat","_x2","_x3","css","_callee3","sheet","_context3","element","CSSStyleSheet","replace","adoptedStyleSheets","_x4","_x5","html","_callee4","reader","promise","result","_context4","FileReader","buffer","srcElement","readAsText","DOMParser","parseFromString","querySelectorAll","map","x","outerHTML","reduce","y","HTMLElement","innerHTML","_x6","_x7","loaders","image","_callee5","_context5","HTMLImageElement","Image","onload","onerror","src","_x8","_x9","javascript","_callee6","_context6","require","_x10","lload","_callee7","loader","_context7","split","t1","_x11","_x12","_fetch","_callee8","resource","_this","_context8","path","_x13","_x14","_load","_callee9","isArrayOpts","_this2","_context9","load","_x15","_x16","_register"],"mappings":"AAAA,aAEA,SAASA,2BAA6B,GAAuB,mBAAZC,QAAwB,OAAO,KAAM,IAAIC,EAAQ,IAAID,QAA6F,OAAlFD,yBAA2B,WAAsC,OAAOE,GAAiBA,EAE1M,SAASC,wBAAwBC,GAAO,GAAIA,GAAOA,EAAIC,WAAc,OAAOD,EAAO,GAAY,OAARA,GAAiC,WAAjBE,QAAQF,IAAoC,mBAARA,EAAsB,MAAO,CAAEG,QAAWH,GAAS,IAAIF,EAAQF,2BAA4B,GAAIE,GAASA,EAAMM,IAAIJ,GAAQ,OAAOF,EAAMO,IAAIL,GAAQ,IAAIM,EAAS,GAAQC,EAAwBC,OAAOC,gBAAkBD,OAAOE,yBAA0B,IAAK,IAAIC,KAAOX,EAAO,GAAIQ,OAAOI,UAAUC,eAAeC,KAAKd,EAAKW,GAAM,CAAE,IAAII,EAAOR,EAAwBC,OAAOE,yBAAyBV,EAAKW,GAAO,KAAUI,IAASA,EAAKV,KAAOU,EAAKC,KAAQR,OAAOC,eAAeH,EAAQK,EAAKI,GAAgBT,EAAOK,GAAOX,EAAIW,GAA4E,OAAhEL,EAAgB,QAAIN,EAASF,GAASA,EAAMkB,IAAIhB,EAAKM,GAAkBA,EAEruB,SAASW,mBAAmBC,GAAO,OAAOC,mBAAmBD,IAAQE,iBAAiBF,IAAQG,4BAA4BH,IAAQI,qBAElI,SAASA,qBAAuB,MAAM,IAAIC,UAAU,wIAEpD,SAASF,4BAA4BG,EAAGC,GAAU,GAAKD,EAAL,CAAgB,GAAiB,iBAANA,EAAgB,OAAOE,kBAAkBF,EAAGC,GAAS,IAAIE,EAAInB,OAAOI,UAAUgB,SAASd,KAAKU,GAAGK,MAAM,GAAI,GAAiE,MAAnD,WAANF,GAAkBH,EAAEM,cAAaH,EAAIH,EAAEM,YAAYC,MAAgB,QAANJ,GAAqB,QAANA,EAAoBK,MAAMC,KAAKN,GAAc,cAANA,GAAqB,2CAA2CO,KAAKP,GAAWD,kBAAkBF,EAAGC,QAAzG,GAE7S,SAASL,iBAAiBe,GAAQ,GAAsB,oBAAXC,QAA0BA,OAAOC,YAAY7B,OAAO2B,GAAO,OAAOH,MAAMC,KAAKE,GAE1H,SAAShB,mBAAmBD,GAAO,GAAIc,MAAMM,QAAQpB,GAAM,OAAOQ,kBAAkBR,GAEpF,SAASQ,kBAAkBR,EAAKqB,IAAkB,MAAPA,GAAeA,EAAMrB,EAAIsB,UAAQD,EAAMrB,EAAIsB,QAAQ,IAAK,IAAIC,EAAI,EAAGC,EAAO,IAAIV,MAAMO,GAAME,EAAIF,EAAKE,IAAOC,EAAKD,GAAKvB,EAAIuB,GAAM,OAAOC,EAEhL,SAASC,QAAQC,EAAQC,GAAkB,IAAIC,EAAOtC,OAAOsC,KAAKF,GAAS,GAAIpC,OAAOuC,sBAAuB,CAAE,IAAIC,EAAUxC,OAAOuC,sBAAsBH,GAAaC,IAAgBG,EAAUA,EAAQC,OAAO,SAAUC,GAAO,OAAO1C,OAAOE,yBAAyBkC,EAAQM,GAAKC,cAAgBL,EAAKM,KAAKC,MAAMP,EAAME,GAAY,OAAOF,EAE9U,SAASQ,cAAcC,GAAU,IAAK,IAAId,EAAI,EAAGA,EAAIe,UAAUhB,OAAQC,IAAK,CAAE,IAAIgB,EAAyB,MAAhBD,UAAUf,GAAae,UAAUf,GAAK,GAAQA,EAAI,EAAKE,QAAQnC,OAAOiD,IAAS,GAAMC,QAAQ,SAAU/C,GAAOgD,gBAAgBJ,EAAQ5C,EAAK8C,EAAO9C,MAAsBH,OAAOoD,0BAA6BpD,OAAOqD,iBAAiBN,EAAQ/C,OAAOoD,0BAA0BH,IAAmBd,QAAQnC,OAAOiD,IAASC,QAAQ,SAAU/C,GAAOH,OAAOC,eAAe8C,EAAQ5C,EAAKH,OAAOE,yBAAyB+C,EAAQ9C,MAAe,OAAO4C,EAE7gB,SAASI,gBAAgB3D,EAAKW,EAAKmD,GAAiK,OAApJnD,KAAOX,EAAOQ,OAAOC,eAAeT,EAAKW,EAAK,CAAEmD,MAAOA,EAAOX,YAAY,EAAMY,cAAc,EAAMC,UAAU,IAAkBhE,EAAIW,GAAOmD,EAAgB9D,EAE3M,SAASiE,gBAAgBC,EAAUC,GAAe,KAAMD,aAAoBC,GAAgB,MAAM,IAAI5C,UAAU,qCAEhH,SAAS6C,kBAAkBb,EAAQc,GAAS,IAAK,IAAI5B,EAAI,EAAGA,EAAI4B,EAAM7B,OAAQC,IAAK,CAAE,IAAI6B,EAAaD,EAAM5B,GAAI6B,EAAWnB,WAAamB,EAAWnB,aAAc,EAAOmB,EAAWP,cAAe,EAAU,UAAWO,IAAYA,EAAWN,UAAW,GAAMxD,OAAOC,eAAe8C,EAAQe,EAAW3D,IAAK2D,IAE7S,SAASC,aAAaJ,EAAaK,EAAYC,GAAmJ,OAAhID,GAAYJ,kBAAkBD,EAAYvD,UAAW4D,GAAiBC,GAAaL,kBAAkBD,EAAaM,GAAqBN,EAEzM,SAASO,mBAAmBC,EAAKC,EAASC,EAAQC,EAAOC,EAAQpE,EAAKqE,GAAO,IAAM,IAAIC,EAAON,EAAIhE,GAAKqE,GAAUlB,EAAQmB,EAAKnB,MAAS,MAAOoB,GAAwB,YAAfL,EAAOK,GAAsBD,EAAKE,KAAQP,EAAQd,GAAiBsB,QAAQR,QAAQd,GAAOuB,KAAKP,EAAOC,GAE7P,SAASO,kBAAkBC,GAAM,OAAO,WAAc,IAAIC,EAAOC,KAAMC,EAAOlC,UAAW,OAAO,IAAI4B,QAAQ,SAAUR,EAASC,GAAU,IAAIF,EAAMY,EAAGlC,MAAMmC,EAAME,GAAO,SAASZ,EAAMhB,GAASY,mBAAmBC,EAAKC,EAASC,EAAQC,EAAOC,EAAQ,OAAQjB,GAAU,SAASiB,EAAOY,GAAOjB,mBAAmBC,EAAKC,EAASC,EAAQC,EAAOC,EAAQ,QAASY,GAAQb,OAAMc,MAEjX,SAAS1F,QAAQF,GAAmV,OAAtOE,QAArD,mBAAXkC,QAAoD,iBAApBA,OAAOC,SAAmC,SAAiBrC,GAAO,cAAcA,GAA2B,SAAiBA,GAAO,OAAOA,GAAyB,mBAAXoC,QAAyBpC,EAAI8B,cAAgBM,QAAUpC,IAAQoC,OAAOxB,UAAY,gBAAkBZ,IAAyBA,IAEnX,SAAW6F,EAAQC,GACqD,YAAlD,oBAAZC,QAA0B,YAAc7F,QAAQ6F,WAA4C,oBAAXC,OAAyBA,OAAOD,QAAUD,IAA8B,mBAAXG,QAAyBA,OAAOC,IAAMD,OAAO,SAAUH,IAAYD,EAASA,GAAUL,MAAaW,OAASL,IADpQ,MAEG,EAAQ,WAGT,IA2GMM,EA4DAC,EAuCAC,EAiDAC,EAsCAC,EA0CAC,EA/UFC,EAAIC,SAASC,cAAc,KAgB3BC,EAAoB,WACtB,OAVqDC,EAU1B,WACzB,OAAOC,WACDC,EAAO1B,kBAAkB2B,mBAAmBC,KAAK,SAASC,EAAQC,GACpE,IAAIC,EAAUC,EACd,OAAOL,mBAAmBM,KAAK,SAAkBC,GAC/C,OACE,OAAQA,EAASC,KAAOD,EAASE,MAC/B,KAAK,EAGH,OAFAF,EAASC,KAAO,EAChBD,EAASE,KAAO,EACTC,MAAMP,EAAMQ,KAAKC,KAAMT,EAAMQ,KAAKE,SAE3C,KAAK,EAGH,OAFAT,EAAWG,EAASO,KACpBP,EAASE,KAAO,EACTL,EAASC,OAElB,KAAK,EACHA,EAAOE,EAASO,KAChBX,EAAMQ,KAAKI,OAASX,EAASW,OAC7BZ,EAAMQ,KAAKK,WAAaZ,EAASY,WACjCb,EAAMQ,KAAKN,KAAOA,EAClBE,EAASE,KAAO,GAChB,MAEF,KAAK,GACHF,EAASC,KAAO,GAChBD,EAASU,GAAKV,EAAgB,MAAE,GAChCJ,EAAMQ,KAAKK,WAAaT,EAASU,GAEnC,KAAK,GACHC,YAAYf,EAAMQ,MAEpB,KAAK,GACL,IAAK,MACH,OAAOJ,EAASY,SAGrBjB,EAAS,KAAM,CAAC,CAAC,EAAG,SAGlB,SAAmBkB,GACxB,OAAOrB,EAAK3D,MAAMoC,KAAMjC,aAzCT,IACbwD,GAXJsB,EAAMC,IAAIC,gBAAgB,IAAIC,KAAK,CAAC,IAAK3B,EAAKlF,WAAY,OAAQ,CACpE8G,KAAM,4BAEJC,EAAS,IAAIC,OAAON,GACxBC,IAAIM,gBAAgBP,GACbK,EANiB,IAA6B7B,EACjDwB,EAGAK,GAsDFG,EAAU,IAAK,WACjB,SAASC,IACP9E,gBAAgBwB,KAAMsD,GAEtBtD,KAAKuD,QAAU,KACfvD,KAAKwD,UAAY,EAgCnB,OA7BA1E,aAAawE,EAAc,CAAC,CAC1BpI,IAAK,YACLmD,MAAO,WAWL,OAVI2B,KAAKwD,UAAY,GACnBxD,KAAKwD,YAGgB,IAAnBxD,KAAKwD,YACPxD,KAAKuD,QAAQE,YAEbzD,KAAKuD,QAAU,MAGVvD,KAAKuD,UAEb,CACDrI,IAAK,SACLmD,MAAO,WAGL,OAFA2B,KAAKwD,YAEDxD,KAAKuD,QACAvD,KAAKuD,SAGdvD,KAAKuD,QAAUnC,IACRpB,KAAKuD,aAITD,EArCS,IAuCdjJ,EAAQ,GAERqJ,GACE/C,EAAQd,kBAAkB2B,mBAAmBC,KAAK,SAASkC,EAASvB,EAAMC,GAC5E,OAAOb,mBAAmBM,KAAK,SAAmB8B,GAChD,OACE,OAAQA,EAAU5B,KAAO4B,EAAU3B,MACjC,KAAK,EAMH,MAAwB,KALxBI,EAAUxE,cAAc,GAAI,CAC1BxD,OAAO,EACP6H,MAAO,IACN,GAAIG,IAEOhI,OAAkB+H,KAAQ/H,GAAQ,CAC9CuJ,EAAU3B,KAAO,EACjB,MAIF,OADA2B,EAAU3B,KAAO,EACV5H,EAAM+H,GAEf,KAAK,EACH,OAAOwB,EAAUC,OAAO,SAAUD,EAAUtB,MAE9C,KAAK,EACH,OAAOsB,EAAUC,OAAO,SAAUxJ,EAAM+H,GAAQ,IAAIzC,QAAQ,SAAUR,EAASC,GAC7E,IAAI8D,EAASG,EAAQH,SACrBA,EAAOR,YAAY,CACjBN,KAAMA,EACNC,QAASA,EAAQH,QAEnBgB,EAAOY,iBAAiB,UAAW,SAAUnC,GAC3C,IAAIQ,EAAOR,EAAMQ,KAEbA,EAAKC,OAASA,IAIlBiB,EAAQI,YAEY,MAAhBtB,EAAKI,OAKTnD,EAAO,IAAI2E,MAAM,GAAGC,OAAO7B,EAAKK,WAAY,SAASwB,OAAO7B,EAAKC,KAAM,gBAJrEjD,EAAQgD,EAAKN,YAQrB,KAAK,EACL,IAAK,MACH,OAAO+B,EAAUjB,SAGtBgB,MAGE,SAAgBM,EAAKC,GAC1B,OAAOvD,EAAM/C,MAAMoC,KAAMjC,aAIzBoG,GACEvD,EAAQf,kBAAkB2B,mBAAmBC,KAAK,SAAS2C,EAASvC,EAAMQ,GAC5E,IAAIQ,EAAKwB,EACT,OAAO7C,mBAAmBM,KAAK,SAAmBwC,GAChD,OACE,OAAQA,EAAUtC,KAAOsC,EAAUrC,MACjC,KAAK,EASH,OARAI,EAAUxE,cAAc,GAAI,CAC1B0G,QAASrD,UACR,CACDmB,QAASA,IAEXQ,EAAMC,IAAIC,gBAAgBlB,GAC1BwC,EAAQ,IAAIG,cACZF,EAAUrC,KAAO,EACVoC,EAAMI,QAAQ,gBAAiBT,OAAOnB,EAAK,OAEpD,KAAK,EAOH,OANAC,IAAIM,gBAAgBP,GAEa,WAA7BpI,QAAQ4H,EAAQkC,UAAyB,uBAAwBlC,EAAQkC,UAC3ElC,EAAQkC,QAAQG,mBAAqB,GAAGV,OAAOxI,mBAAmB6G,EAAQkC,QAAQG,oBAAqB,CAACL,KAGnGC,EAAUT,OAAO,SAAUQ,GAEpC,KAAK,EACL,IAAK,MACH,OAAOC,EAAU3B,SAGtByB,MAGE,SAAaO,EAAKC,GACvB,OAAOhE,EAAMhD,MAAMoC,KAAMjC,aAIzB8G,GACEhE,EAAQhB,kBAAkB2B,mBAAmBC,KAAK,SAASqD,EAASjD,EAAMQ,GAC5E,IAAI0C,EAAQC,EAASC,EACrB,OAAOzD,mBAAmBM,KAAK,SAAmBoD,GAChD,OACE,OAAQA,EAAUlD,KAAOkD,EAAUjD,MACjC,KAAK,EASH,OARA8C,EAAS,IAAII,WACbH,EAAU,IAAIrF,QAAQ,SAAUR,GAC9B,OAAO4F,EAAOjB,iBAAiB,UAAW,SAAUsB,GAClD,OAAOjG,EAAQiG,EAAOC,WAAWJ,YAGrCF,EAAOO,WAAWzD,GAClBqD,EAAUjD,KAAO,EACV+C,EAET,KAAK,EAiBH,OAhBAC,EAASC,EAAU5C,KAEfD,GAAqC,iBAAnBA,EAAQ7E,QAAuB6E,EAAQ7E,OAAOT,SAGlEkI,GADAA,EAASzJ,oBADTyJ,GAAS,IAAIM,WAAYC,gBAAgBP,EAAQ,aAAa5D,MAC3BoE,iBAAiBpD,EAAQ7E,UAC5CT,OAASkI,EAAOS,IAAI,SAAUC,GAC5C,OAAOA,EAAEC,YACRC,OAAO,SAAUF,EAAGG,GACrB,OAAOH,EAAIG,IACRb,GAGH5C,GAAWA,EAAQkC,SAAWlC,EAAQkC,mBAAmBwB,aAAed,GAA4B,iBAAXA,GAAuBA,EAAOlI,SACzHsF,EAAQkC,QAAQyB,UAAYf,GAGvBC,EAAUrB,OAAO,SAAUmB,GAEpC,KAAK,EACL,IAAK,MACH,OAAOE,EAAUvC,SAGtBmC,MAGE,SAAcmB,EAAKC,GACxB,OAAOrF,EAAMjD,MAAMoC,KAAMjC,aAyEzBoI,EAAU,CACZC,OArEItF,EAAQjB,kBAAkB2B,mBAAmBC,KAAK,SAAS4E,EAASxE,EAAMQ,GAC5E,IAAI+D,EAAOvD,EAAKmC,EAASC,EACzB,OAAOzD,mBAAmBM,KAAK,SAAmBwE,GAChD,OACE,OAAQA,EAAUtE,KAAOsE,EAAUrE,MACjC,KAAK,EAYH,OAXAmE,EAAQ/D,GAAWA,EAAQkC,mBAAmBgC,iBAAmBlE,EAAQkC,QAAU,IAAIiC,MACvF3D,EAAMC,IAAIC,gBAAgBlB,GAC1BmD,EAAU,IAAIrF,QAAQ,SAAUR,EAASC,GACvCgH,EAAMK,OAAStH,EAEfiH,EAAMM,QAAU,WACd,OAAOtH,EAAO,IAAI2E,MAAM,uBAAuBC,OAAOnC,EAAKoB,WAG/DmD,EAAMO,IAAM9D,EACZyD,EAAUrE,KAAO,EACV+C,EAET,KAAK,EAGH,OAFAC,EAASqB,EAAUhE,KACnBQ,IAAIM,gBAAgBP,GACbyD,EAAUzC,OAAO,SAAUoB,GAEpC,KAAK,EACL,IAAK,MACH,OAAOqB,EAAU3D,SAGtB0D,MAGE,SAAeO,EAAKC,GACzB,OAAO/F,EAAMlD,MAAMoC,KAAMjC,aAqC3B8G,KAAMA,EACNV,IAAKA,EACL2C,YAlCI/F,EAAQlB,kBAAkB2B,mBAAmBC,KAAK,SAASsF,EAASlF,GACtE,IAAIgB,EAAKoC,EACT,OAAOzD,mBAAmBM,KAAK,SAAmBkF,GAChD,OACE,OAAQA,EAAUhF,KAAOgF,EAAU/E,MACjC,KAAK,EAGH,OAFAY,EAAMC,IAAIC,gBAAgBlB,GAC1BmF,EAAU/E,KAAO,EACVtC,QAAQR,UAAUS,KAAK,WAC5B,OAAOtF,wBAAwB2M,QAAQ,GAAGjD,OAAOnB,OAGrD,KAAK,EAGH,OAFAoC,EAAS+B,EAAU1E,KACnBQ,IAAIM,gBAAgBP,GACbmE,EAAUnD,OAAO,SAAUoB,GAEpC,KAAK,EACL,IAAK,MACH,OAAO+B,EAAUrE,SAGtBoE,MAGE,SAAoBG,GACzB,OAAOnG,EAAMnD,MAAMoC,KAAMjC,cAezBoJ,GACEnG,EAAQnB,kBAAkB2B,mBAAmBC,KAAK,SAAS2F,EAASvF,EAAMQ,GAC5E,IAAIY,EAAM5F,EAAMnC,EAAKmM,EACrB,OAAO7F,mBAAmBM,KAAK,SAAmBwF,GAChD,OACE,OAAQA,EAAUtF,KAAOsF,EAAUrF,MACjC,KAAK,EACHgB,EAAOpB,EAAKoB,KACZ5F,EAAO4F,EAAKsE,MAAM,KAAK1B,OAAO,SAAUF,EAAGG,GACzC,MAAO,CAAC7C,EAAM0C,EAAGG,KAEnBwB,EAAU7E,GAAKjB,mBAAmBnE,KAAKA,GAEzC,KAAK,EACH,IAAKiK,EAAUE,GAAKF,EAAU7E,MAAM/C,KAAM,CACxC4H,EAAUrF,KAAO,GACjB,MAMF,GAHA/G,EAAMoM,EAAUE,GAAGnJ,SACnBgJ,EAAShK,EAAKnC,MAEEiL,GAAU,CACxBmB,EAAUrF,KAAO,GACjB,MAIF,OADAqF,EAAUrF,KAAO,EACVkE,EAAQkB,GAAQxF,EAAMQ,GAE/B,KAAK,EACH,OAAOiF,EAAUzD,OAAO,SAAUyD,EAAUhF,MAE9C,KAAK,GACHgF,EAAUrF,KAAO,EACjB,MAEF,KAAK,GACH,MAAM,IAAInG,UAAU,WAAWkI,OAAOnC,EAAKoB,KAAM,sDAEnD,KAAK,GACL,IAAK,MACH,OAAOqE,EAAU3E,SAGtByE,MAGE,SAAeK,EAAMC,GAC1B,OAAO1G,EAAMpD,MAAMoC,KAAMjC,aAmJ7B,OA/Ia,WACX,SAAS2C,IACPlC,gBAAgBwB,KAAMU,GA0IxB,OAvIA5B,aAAa4B,EAAQ,CAAC,CACpBxF,IAAK,QACLmD,MAAO,WACL,IAAIsJ,EAAS9H,kBAAkB2B,mBAAmBC,KAAK,SAASmG,EAASC,EAAUxF,GACjF,IAAIyF,EAAQ9H,KAEZ,OAAOwB,mBAAmBM,KAAK,SAAmBiG,GAChD,OACE,OAAQA,EAAU/F,KAAO+F,EAAU9F,MACjC,KAAK,EACH,IAAK1F,MAAMM,QAAQgL,GAAW,CAC5BE,EAAU9F,KAAO,EACjB,MAIF,OADA8F,EAAU9F,KAAO,EACV4F,EAASnC,IAAI,SAAUzE,GAC5B,OAAO6G,EAAM5F,MAAMjB,EAAGoB,KAG1B,KAAK,EACH,OAAO0F,EAAUlE,OAAO,SAAUkE,EAAUzF,MAE9C,KAAK,EACH,GAA0B,iBAAbuF,EAAwB,CACnCE,EAAU9F,KAAO,EACjB,MAIF,OADA8F,EAAU9F,KAAO,EACVjC,KAAKkC,OApaC8F,EAoaYH,EAnavC5G,EAAEmB,KAAO4F,EACF,IAAIlF,IAAI7B,EAAEmB,OAkaiCC,GAEtC,KAAK,EACH,OAAO0F,EAAUlE,OAAO,SAAUkE,EAAUzF,MAE9C,KAAK,EACH,KAAMuF,aAAoB/E,KAAM,CAC9BiF,EAAU9F,KAAO,GACjB,MAIF,OADA8F,EAAU9F,KAAO,GACVyB,EAAOmE,EAASzF,KAAMC,GAE/B,KAAK,GACH,OAAO0F,EAAUlE,OAAO,SAAUkE,EAAUzF,MAE9C,KAAK,GACH,MAAM,IAAIxG,UAAU,2BAA2BkI,OAAOvJ,QAAQoN,GAAW,4CAE3E,KAAK,GACL,IAAK,MACH,OAAOE,EAAUpF,OA1bpB,IAAgBqF,GA6blBJ,EAAU5H,SAOf,OAJA,SAAeiI,EAAMC,GACnB,OAAOP,EAAO/J,MAAMoC,KAAMjC,YAzDvB,IA8DN,CACD7C,IAAK,OACLmD,MAAO,WACL,IAAI8J,EAAQtI,kBAAkB2B,mBAAmBC,KAAK,SAAS2G,EAASP,EAAUxF,GAChF,IAEIgG,EAAaxG,EAFbyG,EAAStI,KAGb,OAAOwB,mBAAmBM,KAAK,SAAmByG,GAChD,OACE,OAAQA,EAAUvG,KAAOuG,EAAUtG,MACjC,KAAK,EACH,IAAK1F,MAAMM,QAAQgL,GAAW,CAC5BU,EAAUtG,KAAO,EACjB,MAKF,OAFAoG,EAAc9L,MAAMM,QAAQwF,GAC5BkG,EAAUtG,KAAO,EACV4F,EAASnC,IAAI,SAAUzE,EAAGjE,GAC/B,OAAOsL,EAAOE,KAAKvH,EAAGoH,EAAchG,EAAQrF,GAAKqF,KAGrD,KAAK,EACH,OAAOkG,EAAU1E,OAAO,SAAU0E,EAAUjG,MAE9C,KAAK,EACH,KAAMuF,aAAoB7E,MAAO,CAC/BuF,EAAUtG,KAAO,EACjB,MAGFsG,EAAU9F,GAAKoF,EACfU,EAAUtG,KAAO,GACjB,MAEF,KAAK,EAEH,OADAsG,EAAUtG,KAAO,GACVjC,KAAKkC,MAAM2F,EAAUxF,GAE9B,KAAK,GACHkG,EAAU9F,GAAK8F,EAAUjG,KAE3B,KAAK,GAGH,OAFAT,EAAO0G,EAAU9F,GACjB8F,EAAUtG,KAAO,GACVkF,EAAMtF,EAAMQ,GAErB,KAAK,GACH,OAAOkG,EAAU1E,OAAO,SAAU0E,EAAUjG,MAE9C,KAAK,GACL,IAAK,MACH,OAAOiG,EAAU5F,SAGtByF,EAAUpI,SAOf,OAJA,SAAcyI,EAAMC,GAClB,OAAOP,EAAMvK,MAAMoC,KAAMjC,YAzDtB,IA8DN,CACD7C,IAAK,WACLmD,MAAO,SAAkB4E,EAAMoE,GAC7B,OAjMU,SAAkBpE,EAAMoE,GACtC,OAAOlB,EAAQlD,GAAQoE,EAgMZsB,CAAU1F,EAAMoE,OAIpB3G,EA5II","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define('Loader', factory) :\n    (global = global || self, global.Loader = factory());\n}(this, (function () { 'use strict';\n\n    const a = document.createElement(\"a\");\n\n    /**\n     *\n     * @param {String} path\n     * @returns {URL}\n     */\n    const getURL = (path) => {\n        a.href = path;\n\n        return new URL(a.href);\n    };\n\n    /**\n     *\n     * @private\n     * @static\n     * TODO: provide unit test\n     */\n    const createDynamicWorker = (body) => {\n        // ...\n        const url = URL.createObjectURL(\n            new Blob([\"(\", body.toString(), \")()\"], {\n                type: \"application/javascript\",\n            })\n        );\n\n        // ...\n        const worker = new Worker(url);\n\n        // ...\n        URL.revokeObjectURL(url);\n\n        // ...\n        return worker;\n    };\n\n    /**\n     *\n     * @private\n     * @static\n     * TODO: provide unit test\n     */\n    const createFetchWorker = () =>\n        createDynamicWorker(\n            () =>\n                (onmessage = async (event) => {\n                    //\n                    try {\n                        const response = await fetch(\n                            event.data.href,\n                            event.data.options\n                        );\n                        const blob = await response.blob();\n\n                        event.data.status = response.status;\n                        event.data.statusText = response.statusText;\n                        event.data.blob = blob;\n                    } catch (e) {\n                        event.data.statusText = e;\n                    }\n\n                    // ...\n                    postMessage(event.data);\n                })\n        );\n\n    /**\n     *\n     */\n    var lworker = new (class LoaderWorker {\n        constructor() {\n            this._worker = null;\n\n            this._requests = 0;\n        }\n\n        terminate() {\n            //\n            //\n            if (this._requests > 0) {\n                this._requests--;\n            }\n\n            //\n            if (this._requests === 0) {\n                this._worker.terminate();\n\n                this._worker = null;\n            }\n\n            //\n            return this._worker;\n        }\n\n        worker() {\n            // ...\n            this._requests++;\n\n            // ...\n            if (this._worker) {\n                return this._worker;\n            }\n\n            // ...\n            this._worker = createFetchWorker();\n\n            //\n            return this._worker;\n        }\n    })();\n\n    // ...\n    const cache = {};\n\n    /**\n     * Fetches a resource url in the secondary thread and retrieves it as a blob\n     * @private\n     * @param {String} href The resource url to be fetched\n     * @param {Object} options The fetch options object\n     * @returns {Promise} The fetch promise\n     */\n    var lfetch = async (href, options) => {\n        // ...\n        options = {\n            ...{\n                cache: true,\n                fetch: {},\n            },\n            ...options,\n        };\n\n        // ...\n        if (options.cache === true && href in cache) {\n            return await cache[href];\n        }\n\n        // ...\n        return (cache[href] = new Promise((resolve, reject) => {\n            //\n            const worker = lworker.worker();\n\n            // ...\n            worker.postMessage({\n                href: href,\n                options: options.fetch,\n            });\n\n            // ...\n            // TODO: possibly use messageerror for reject?\n            worker.addEventListener(\"message\", (event) => {\n                const data = event.data;\n\n                // ...\n                if (data.href !== href) {\n                    return;\n                }\n\n                //\n                lworker.terminate();\n\n                // ...\n                if (data.status === 200) {\n                    resolve(data.blob);\n\n                    return;\n                }\n\n                // ...\n                reject(new Error(`${data.statusText} for ${data.href} resource.`));\n            });\n        }));\n    };\n\n    var css = async (blob, options) => {\n        //\n        options = { ...{ element: document }, options };\n\n        //\n        const url = URL.createObjectURL(blob);\n\n        //\n        const sheet = new CSSStyleSheet();\n\n        //\n        await sheet.replace(`@import url(\"${url}\")`);\n\n        //\n        URL.revokeObjectURL(url);\n\n        //\n        if (\n            typeof options.element === \"object\" &&\n            \"adoptedStyleSheets\" in options.element\n        ) {\n            options.element.adoptedStyleSheets = [\n                ...options.element.adoptedStyleSheets,\n                sheet,\n            ];\n        }\n\n        //\n        return sheet;\n    };\n\n    var html = async (blob, options) => {\n        //\n        const reader = new FileReader();\n\n        //\n        const promise = new Promise((resolve) =>\n            reader.addEventListener(\"loadend\", (buffer) =>\n                resolve(buffer.srcElement.result)\n            )\n        );\n\n        //\n        reader.readAsText(blob);\n\n        //\n        let result = await promise;\n\n        //\n        if (\n            options &&\n            typeof options.filter === \"string\" &&\n            options.filter.length\n        ) {\n            //\n            result = new DOMParser().parseFromString(result, \"text/html\").body;\n            //\n            result = [...result.querySelectorAll(options.filter)];\n            //\n            result = result.length\n                ? result.map((x) => x.outerHTML).reduce((x, y) => x + y)\n                : result;\n        }\n\n        //\n        if (\n            options &&\n            options.element &&\n            options.element instanceof HTMLElement &&\n            result &&\n            typeof result === \"string\" &&\n            result.length\n        ) {\n            options.element.innerHTML = result;\n        }\n\n        //\n        return promise;\n    };\n\n    var image = async (blob, options) => {\n        //\n        const image =\n            options && options.element instanceof HTMLImageElement\n                ? options.element\n                : new Image();\n\n        //\n        const url = URL.createObjectURL(blob);\n\n        //\n        const promise = new Promise((resolve, reject) => {\n            image.onload = resolve;\n            image.onerror = () =>\n                reject(new Error(`Error loading image ${blob.type}`));\n        });\n\n        //\n        image.src = url;\n\n        //\n        const result = await promise;\n\n        //\n        URL.revokeObjectURL(url);\n\n        //\n        return result;\n    };\n\n    var javascript = async (blob) => {\n        //\n        const url = URL.createObjectURL(blob);\n\n        //\n        const result = await import(url);\n\n        //\n        URL.revokeObjectURL(url);\n\n        //\n        return result;\n    };\n\n    // loaders closure, filled with default loaders\n    // https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types\n    let loaders = {\n        image: image,\n        html: html,\n        css: css,\n        javascript: javascript,\n    };\n\n    /**\n     *\n     * @param {String} type\n     * @param {Function} loader\n     * @returns {void}\n     */\n    const register = (type, loader) => (loaders[type] = loader);\n\n    /**\n     * Loads a resource, which usually consists in attaching it to an existent DOM element\n     * @private\n     * @param {Blob} blob The resource to be loaded in Blob form\n     * @param {Object} options The resource load options\n     * @returns {Promise} The resource load in promise form\n     */\n    var lload = async (blob, options) => {\n        const type = blob.type;\n\n        //...\n        const keys = type.split(\"/\").reduce((x, y) => [type, x, y]);\n\n        // ...\n        for (const key in keys) {\n            const loader = keys[key];\n\n            if (loader in loaders) {\n                return await loaders[loader](blob, options);\n            }\n        }\n\n        // ...\n        throw new TypeError(\n            `Invalid ${blob.type} media type passed to Loader class \"load\" method.`\n        );\n    };\n\n    class Loader {\n        constructor() {}\n\n        /**\n         * Fetches one or more resources url\n         * @param {Array.<String>|Array.<URL>|String|URL} resource The resource(s) url to be fetched in a separate thread\n         * @param {Object} options The fetch options object\n         * @returns {Array.<Promise>|Promise} The fetch promise(s)\n         */\n        async fetch(resource, options) {\n            // ...\n            if (Array.isArray(resource)) {\n                return await resource.map((a) => this.fetch(a, options));\n            }\n\n            // ...\n            if (typeof resource === \"string\") {\n                return await this.fetch(getURL(resource), options);\n            }\n\n            // ...\n            if (resource instanceof URL) {\n                return await lfetch(resource.href, options);\n            }\n\n            // ...\n            throw new TypeError(\n                `Invalid argment of type ${typeof resource} passed to Loader class \"fetch\" method.`\n            );\n        }\n\n        /**\n         * Loads one or more resources url considering the passed options object and the resource mime type to be loaded\n         * @param {Array.<String>|Array.<URL>|Array.<Blob>|String|URL|Blob} resource The resource(s) to be loaded\n         * @param {Object} options The loader type options\n         * @returns {Array.<Promise>|Promise} The load promise(s)\n         */\n        async load(resource, options) {\n            // ...\n            if (Array.isArray(resource)) {\n                const isArrayOpts = Array.isArray(options);\n\n                return await resource.map((a, i) =>\n                    this.load(a, isArrayOpts ? options[i] : options)\n                );\n            }\n\n            // ...\n            const blob =\n                resource instanceof Blob\n                    ? resource\n                    : await this.fetch(resource, options);\n\n            // ...\n            return await lload(blob, options);\n        }\n\n        /**\n         *\n         * @param {String} type\n         * @param {Function} loader\n         * @returns {void}\n         */\n        register(type, loader) {\n            return register(type, loader);\n        }\n    }\n\n    return Loader;\n\n})));\n"],"file":"loader.es5.min.js"}