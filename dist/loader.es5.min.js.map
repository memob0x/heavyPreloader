{"version":3,"sources":["loader.mjs"],"names":["_getRequireWildcardCache","WeakMap","cache","_interopRequireWildcard","obj","__esModule","_typeof","default","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","o","minLen","_arrayLikeToArray","n","toString","slice","constructor","name","Array","from","test","iter","Symbol","iterator","isArray","len","length","i","arr2","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","enumerable","push","apply","_objectSpread","target","arguments","source","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","value","configurable","writable","_classCallCheck","instance","Constructor","_defineProperties","props","descriptor","_createClass","protoProps","staticProps","asyncGeneratorStep","gen","resolve","reject","_next","_throw","arg","info","error","done","Promise","then","_asyncToGenerator","fn","self","this","args","err","undefined","global","factory","exports","module","define","amd","Loader","_ref2","_ref3","_ref4","_ref5","_ref6","_ref7","a","document","createElement","createFetchWorker","body","onmessage","_ref","regeneratorRuntime","mark","_callee","event","response","blob","wrap","_context","prev","next","fetch","data","href","options","sent","status","statusText","t0","postMessage","stop","_x","url","URL","createObjectURL","Blob","type","worker","Worker","revokeObjectURL","lworker","LoaderWorker","_worker","_requests","terminate","lfetch","_callee2","_context2","abrupt","addEventListener","Error","concat","_x2","_x3","css","_callee3","sheet","_context3","element","CSSStyleSheet","replace","adoptedStyleSheets","_x4","_x5","html","_callee4","reader","promise","result","_context4","FileReader","buffer","srcElement","readAsText","DOMParser","parseFromString","querySelectorAll","map","x","outerHTML","reduce","y","HTMLElement","innerHTML","_x6","_x7","image","_callee5","_context5","HTMLImageElement","Image","onload","onerror","src","_x8","_x9","javascript","_callee6","_context6","require","_x10","lload","_callee7","_context7","_x11","_x12","_fetch","_callee8","resource","_this","_context8","path","_x13","_x14","_load","_callee9","isArrayOpts","_this2","_context9","load","_x15","_x16"],"mappings":"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","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define('Loader', factory) :\n    (global = global || self, global.Loader = factory());\n}(this, (function () { 'use strict';\n\n    const a = document.createElement(\"a\");\n\n    /**\n     *\n     * @param {String} path\n     * @returns {URL}\n     */\n    const getURL = (path) => {\n        a.href = path;\n\n        return new URL(a.href);\n    };\n\n    /**\n     *\n     * @private\n     * @static\n     * TODO: provide unit test\n     */\n    const createDynamicWorker = (body) => {\n        // ...\n        const url = URL.createObjectURL(\n            new Blob([\"(\", body.toString(), \")()\"], {\n                type: \"application/javascript\",\n            })\n        );\n\n        // ...\n        const worker = new Worker(url);\n\n        // ...\n        URL.revokeObjectURL(url);\n\n        // ...\n        return worker;\n    };\n\n    /**\n     *\n     * @private\n     * @static\n     * TODO: provide unit test\n     */\n    const createFetchWorker = () =>\n        createDynamicWorker(\n            () =>\n                (onmessage = async (event) => {\n                    //\n                    try {\n                        const response = await fetch(\n                            event.data.href,\n                            event.data.options\n                        );\n                        const blob = await response.blob();\n\n                        event.data.status = response.status;\n                        event.data.statusText = response.statusText;\n                        event.data.blob = blob;\n                    } catch (e) {\n                        event.data.statusText = e;\n                    }\n\n                    // ...\n                    postMessage(event.data);\n                })\n        );\n\n    /**\n     *\n     */\n    var lworker = new (class LoaderWorker {\n        constructor() {\n            this._worker = null;\n\n            this._requests = 0;\n        }\n\n        terminate() {\n            //\n            //\n            if (this._requests > 0) {\n                this._requests--;\n            }\n\n            //\n            if (this._requests === 0) {\n                this._worker.terminate();\n\n                this._worker = null;\n            }\n\n            //\n            return this._worker;\n        }\n\n        worker() {\n            // ...\n            this._requests++;\n\n            // ...\n            if (this._worker) {\n                return this._worker;\n            }\n\n            // ...\n            this._worker = createFetchWorker();\n\n            //\n            return this._worker;\n        }\n    })();\n\n    // ...\n    const cache = {};\n\n    /**\n     * Fetches a resource url in the secondary thread and retrieves it as a blob\n     * @private\n     * @param {String} href The resource url to be fetched\n     * @param {Object} options The fetch options object\n     * @returns {Promise} The fetch promise\n     */\n    var lfetch = async (href, options) => {\n        // ...\n        options = {\n            ...{\n                cache: true,\n                fetch: {},\n            },\n            ...options,\n        };\n\n        // ...\n        if (options.cache === true && href in cache) {\n            return await cache[href];\n        }\n\n        // ...\n        return (cache[href] = new Promise((resolve, reject) => {\n            //\n            const worker = lworker.worker();\n\n            // ...\n            worker.postMessage({\n                href: href,\n                options: options.fetch,\n            });\n\n            // ...\n            // TODO: possibly use messageerror for reject?\n            worker.addEventListener(\"message\", (event) => {\n                const data = event.data;\n\n                // ...\n                if (data.href !== href) {\n                    return;\n                }\n\n                //\n                lworker.terminate();\n\n                // ...\n                if (data.status === 200) {\n                    resolve(data.blob);\n\n                    return;\n                }\n\n                // ...\n                reject(new Error(`${data.statusText} for ${data.href} resource.`));\n            });\n        }));\n    };\n\n    var css = async (blob, options) => {\n        //\n        options = { ...{ element: document }, options };\n\n        //\n        const url = URL.createObjectURL(blob);\n\n        //\n        const sheet = new CSSStyleSheet();\n\n        //\n        await sheet.replace(`@import url(\"${url}\")`);\n\n        //\n        URL.revokeObjectURL(url);\n\n        //\n        if (\n            typeof options.element === \"object\" &&\n            \"adoptedStyleSheets\" in options.element\n        ) {\n            options.element.adoptedStyleSheets = [\n                ...options.element.adoptedStyleSheets,\n                sheet,\n            ];\n        }\n\n        //\n        return sheet;\n    };\n\n    var html = async (blob, options) => {\n        //\n        const reader = new FileReader();\n\n        //\n        const promise = new Promise((resolve) =>\n            reader.addEventListener(\"loadend\", (buffer) =>\n                resolve(buffer.srcElement.result)\n            )\n        );\n\n        //\n        reader.readAsText(blob);\n\n        //\n        let result = await promise;\n\n        //\n        if (\n            options &&\n            typeof options.filter === \"string\" &&\n            options.filter.length\n        ) {\n            //\n            result = new DOMParser().parseFromString(result, \"text/html\").body;\n            //\n            result = [...result.querySelectorAll(options.filter)];\n            //\n            result = result.length\n                ? result.map((x) => x.outerHTML).reduce((x, y) => x + y)\n                : result;\n        }\n\n        //\n        if (\n            options &&\n            options.element &&\n            options.element instanceof HTMLElement &&\n            result &&\n            typeof result === \"string\" &&\n            result.length\n        ) {\n            options.element.innerHTML = result;\n        }\n\n        //\n        return promise;\n    };\n\n    var image = async (blob, options) => {\n        //\n        const image =\n            options && options.element instanceof HTMLImageElement\n                ? options.element\n                : new Image();\n\n        //\n        const url = URL.createObjectURL(blob);\n\n        //\n        const promise = new Promise((resolve, reject) => {\n            image.onload = resolve;\n            image.onerror = () =>\n                reject(new Error(`Error loading image ${blob.type}`));\n        });\n\n        //\n        image.src = url;\n\n        //\n        const result = await promise;\n\n        //\n        URL.revokeObjectURL(url);\n\n        //\n        return result;\n    };\n\n    var javascript = async (blob) => {\n        //\n        const url = URL.createObjectURL(blob);\n\n        //\n        const result = await import(url);\n\n        //\n        URL.revokeObjectURL(url);\n\n        //\n        return result;\n    };\n\n    /**\n     * Loads a resource, which usually consists in attaching it to an existent DOM element\n     * @private\n     * @param {Blob} blob The resource to be loaded in Blob form\n     * @param {Object} options The resource load options\n     * @returns {Promise} The resource load in promise form\n     */\n    var lload = async (blob, options) => {\n        //...\n        // TODO: get all major mimetypes\n        switch (blob.type) {\n            //...\n            case \"image/png\":\n            case \"image/jpeg\":\n            case \"image/gif\":\n                return await image(blob, options);\n\n            //...\n            case \"text/html\":\n                return await html(blob, options);\n\n            //...\n            case \"text/css\":\n                return await css(blob, options);\n\n            //...\n            case \"text/javascript\":\n            case \"application/javascript\":\n                return await javascript(blob);\n        }\n\n        // ...\n        throw new TypeError(\n            `Invalid ${blob.type} media type passed to Loader class \"load\" method.`\n        );\n    };\n\n    class Loader {\n        constructor() {}\n\n        /**\n         * Fetches one or more resources url\n         * @param {Array.<String>|Array.<URL>|String|URL} resource The resource(s) url to be fetched in a separate thread\n         * @param {Object} options The fetch options object\n         * @returns {Array.<Promise>|Promise} The fetch promise(s)\n         */\n        async fetch(resource, options) {\n            // ...\n            if (Array.isArray(resource)) {\n                return await resource.map((a) => this.fetch(a, options));\n            }\n\n            // ...\n            if (typeof resource === \"string\") {\n                return await this.fetch(getURL(resource), options);\n            }\n\n            // ...\n            if (resource instanceof URL) {\n                return await lfetch(resource.href, options);\n            }\n\n            // ...\n            throw new TypeError(\n                `Invalid argment of type ${typeof resource} passed to Loader class \"fetch\" method.`\n            );\n        }\n\n        /**\n         * Loads one or more resources url considering the passed options object and the resource mime type to be loaded\n         * @param {Array.<String>|Array.<URL>|Array.<Blob>|String|URL|Blob} resource The resource(s) to be loaded\n         * @param {Object} options The loader type options\n         * @returns {Array.<Promise>|Promise} The load promise(s)\n         */\n        async load(resource, options) {\n            // ...\n            if (Array.isArray(resource)) {\n                const isArrayOpts = Array.isArray(options);\n\n                return await resource.map((a, i) =>\n                    this.load(a, isArrayOpts ? options[i] : options)\n                );\n            }\n\n            // ...\n            const blob =\n                resource instanceof Blob\n                    ? resource\n                    : await this.fetch(resource, options);\n\n            // ...\n            return await lload(blob, options);\n        }\n    }\n\n    return Loader;\n\n})));\n"],"file":"loader.es5.min.js"}