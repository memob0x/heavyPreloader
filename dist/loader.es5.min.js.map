{"version":3,"sources":["loader.mjs"],"names":["ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","obj","value","configurable","writable","_classCallCheck","instance","Constructor","TypeError","_defineProperties","props","descriptor","_createClass","protoProps","staticProps","prototype","asyncGeneratorStep","gen","resolve","reject","_next","_throw","arg","info","error","done","Promise","then","_asyncToGenerator","fn","self","this","args","err","undefined","_typeof","Symbol","iterator","constructor","global","factory","exports","module","define","amd","Loader","_ref2","work","_ref","onmessage","regeneratorRuntime","mark","_callee","event","data","message","response","blob","wrap","_context","prev","next","fetch","href","options","sent","status","statusText","t0","postMessage","stop","_x","worker","getOrCreateWorker","concat","url","URL","createObjectURL","Blob","toString","type","Worker","revokeObjectURL","createWorker","cache","fetch$1","_callee2","_args2","_context2","abrupt","addEventListener","Error","_x2","cors","a","_this","Array","isArray","map","document","createElement"],"mappings":"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","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define('Loader', factory) :\n    (global = global || self, global.Loader = factory());\n}(this, (function () { 'use strict';\n\n    /**\n     *\n     * @private\n     * @static\n     * @param {String} href\n     * @returns {URL}\n     */\n    const getURL = (href) =>\n        new URL(\n            ((a) => {\n                a.href = href;\n\n                return a;\n            })(document.createElement(\"a\"))\n        );\n\n    /**\n     *\n     * @private\n     * @static\n     * @param {Function} work\n     * @returns {Worker}\n     */\n    const createWorker = (work) => {\n        if (typeof work !== \"function\") {\n            throw new TypeError(\n                `Invalid argment of type ${typeof work} passed to Loader class internal \"createWorker\" function.`\n            );\n        }\n\n        const url = URL.createObjectURL(\n            new Blob([\"(\", work.toString(), \")()\"], {\n                type: \"application/javascript\",\n            })\n        );\n\n        const worker = new Worker(url);\n\n        URL.revokeObjectURL(url);\n\n        return worker;\n    };\n\n    /**\n     *\n     * @private\n     * @static\n     */\n    const work = () => {\n        onmessage = async (event) => {\n            const data = event.data;\n\n            // ...\n            let message;\n            try {\n                const response = await fetch(data.href, data.options);\n                const blob = await response.blob();\n\n                message = {\n                    status: response.status,\n                    statusText: response.statusText,\n                    blob: blob,\n                };\n            } catch (e) {\n                message = {\n                    status: 0,\n                    statusText: e,\n                };\n            }\n\n            // ...\n            message.href = data.href;\n            postMessage(message);\n        };\n    };\n\n    // ...\n    let worker = null;\n\n    /**\n     *\n     * @private\n     */\n    const getOrCreateWorker = () =>\n        worker ? worker : (worker = createWorker(work));\n\n    // ...\n    const cache = {};\n\n    /**\n     *\n     * @private\n     * @param {String} href\n     * @param {Object} options\n     */\n    var fetch$1 = async (href, options = {}) => {\n        // ...\n        if (href in cache) {\n            return await cache[href];\n        }\n\n        // ...\n        return (cache[href] = new Promise((resolve, reject) => {\n            const worker = getOrCreateWorker();\n\n            // ...\n            worker.postMessage({\n                href: href,\n                options: options.fetch,\n            });\n\n            // ...\n            worker.addEventListener(\"message\", (event) => {\n                const data = event.data;\n\n                // ...\n                if (data.href !== href) {\n                    return;\n                }\n\n                // ...\n                if (data.status === 200) {\n                    resolve(data.blob);\n\n                    return;\n                }\n\n                // ...\n                reject(new Error(`${data.statusText} for ${data.href} resource.`));\n            });\n        }));\n    };\n\n    class Loader {\n        /**\n         *\n         * @param {Object} options\n         */\n        constructor(options) {\n            this.options = { ...{ fetch: { cors: \"no-cors\" } }, ...options };\n        }\n\n        /**\n         *\n         * @param {Array.<String>|Array.<URL>|String|URL} arg\n         * @returns {Array.<Promise>|Promise}\n         */\n        fetch(arg) {\n            // ...\n            if (Array.isArray(arg)) {\n                return arg.map((a) => this.fetch(a));\n            }\n\n            // ...\n            if (typeof arg === \"string\") {\n                return this.fetch(getURL(arg));\n            }\n\n            // ...\n            if (arg instanceof URL) {\n                return fetch$1(arg.href, this.options);\n            }\n\n            // ...\n            return Promise.reject(\n                new TypeError(\n                    `Invalid argment of type ${typeof arg} passed to Loader class \"fetch\" method.`\n                )\n            );\n        }\n    }\n\n    return Loader;\n\n})));\n"],"file":"loader.es5.min.js"}